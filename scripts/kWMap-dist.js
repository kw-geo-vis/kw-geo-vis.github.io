var KWMap={settings:{container:"map",maxZoom:18,minZoom:8,center:[52.878997,-1.078088],iconDir:"./imgs",layerName:{Fossil:["Fossils","Collected Data"],Measurement:["Measurements","Collected Data"],Borehole:["Boreholes","Collected Data"],Rock:["Rocks","Collected Data"],Empty:["No Additional Data","Additional Data"],BedRock:["BGS Bedrock Data","Additional Data"],Superficial:["BGS Superficial Deposits Data","Additional Data"],Artificial:["BGS Artificial Ground","Additional Data"]}},map:void 0,searchControl:void 0,layerControl:void 0,_createMap:function(){this.map=L.map(this.settings.container),L.Icon.Default.imagePath=this.settings.iconDir,L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors',maxZoom:this.settings.maxZoom,minZoom:this.settings.minZoom}).addTo(this.map),this.map.setView(new L.LatLng(this.settings.center[0],this.settings.center[1]),15),this.map.fire("modal",{content:"<h1>KeyVis</h1><p>Welcome to KEYVis</h1>"})},_setupGeocoding:function(){this.searchControl=L.esri.Geocoding.geosearch({zoomToResult:!1,providers:[L.esri.Geocoding.arcgisOnlineProvider({countries:"GBR"})],useMapBounds:!1,expanded:!0,collapseAfterResult:!1,position:"topright"}).addTo(this.map)},_setupLayerControl:function(){var t={exclusiveGroups:["Additional Data"],collapsed:!0,position:"bottomleft"};this.layerControl=L.control.groupedLayers(null,null,t),this.layerControl.addTo(this.map)},checkAndNavigateToSearchReuslts:function(t){var e=DataLayer.dataBounds.pad(.5);e.contains(t.latlng)?this.map.panTo(t.latlng):this.map.fire("modal",{title:"Are you sure?",content:"The location you have selected is not in the vacinity of any data points.  Navigate there anyway?",template:['<div class="modal-header"><h2>{title}</h2></div>',"<hr>",'<div class="modal-body">{content}</div>','<div class="modal-footer">','<button class="topcoat-button--large {OK_CLS}">{okText}</button>','<button class="topcoat-button--large {CANCEL_CLS}">{cancelText}</button>',"</div>"].join(""),okText:"Yes",cancelText:"No",OK_CLS:"modal-ok",CANCEL_CLS:"modal-cancel",width:300,onShow:function(e){var i=e.modal;L.DomEvent.on(i._container.querySelector(".modal-ok"),"click",function(){KWMap.map.panTo(t.latlng),i.hide()}).on(i._container.querySelector(".modal-cancel"),"click",function(){i.hide()})}})},_displaySearchResults:function(){var t=L.layerGroup().addTo(this.map);this.searchControl.on("results",function(e){console.log(e),t.clearLayers();for(var i=e.results.length-1;i>=0;i--){var n=L.marker(e.results[i].latlng);n.bindPopup("<strong>Search Result:</strong> "+e.text),t.addLayer(n),KWMap.checkAndNavigateToSearchReuslts(e.results[i])}})},addLayers:function(t){for(var e in t)console.log(t[e]),console.log(e),this.layerControl.addOverlay(t[e],this.settings.layerName[e][0],this.settings.layerName[e][1]),"Collected Data"==this.settings.layerName[e][1]&&t[e].addTo(this.map),"No Additional Data"==this.settings.layerName[e][0]&&(console.log("ok"),t[e].addTo(this.map))},init:function(){this._createMap(),this._setupGeocoding(),this._setupLayerControl(),this._displaySearchResults()}};
